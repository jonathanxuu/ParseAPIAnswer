// Copyright 2021-2023 zcloak authors & contributors
// SPDX-License-Identifier: Apache-2.0

import { scrypt } from '@noble/hashes/scrypt';
import { u8aToU8a } from '@polkadot/util';
import { randomAsU8a } from "../random/asU8a.js";
import { DEFAULT_PARAMS } from "./defaults.js";
export function scryptEncode(passphrase, salt = randomAsU8a(), params = DEFAULT_PARAMS) {
  const u8a = u8aToU8a(passphrase);
  return {
    params,
    password: scrypt(u8a, salt, {
      dkLen: 64,
      ...params
    }),
    salt
  };
}