"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.scryptEncode = scryptEncode;
var _scrypt = require("@noble/hashes/scrypt");
var _util = require("@polkadot/util");
var _asU8a = require("../random/asU8a");
var _defaults = require("./defaults");
// Copyright 2021-2023 zcloak authors & contributors
// SPDX-License-Identifier: Apache-2.0

function scryptEncode(passphrase) {
  let salt = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : (0, _asU8a.randomAsU8a)();
  let params = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : _defaults.DEFAULT_PARAMS;
  const u8a = (0, _util.u8aToU8a)(passphrase);
  return {
    params,
    password: (0, _scrypt.scrypt)(u8a, salt, {
      dkLen: 64,
      ...params
    }),
    salt
  };
}