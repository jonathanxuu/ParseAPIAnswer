"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.eip191HashMessage = eip191HashMessage;
var _util = require("@polkadot/util");
var _keccak = require("../keccak");
// Copyright 2021-2023 zcloak authors & contributors
// SPDX-License-Identifier: Apache-2.0

/**
 * @name eip191HashMessage
 * @description
 * keccak256 hash `message` with eip191 method, returns `Uint8Array`. See https://eips.ethereum.org/EIPS/eip-191
 */
function eip191HashMessage(message) {
  const messageU8a = (0, _util.u8aToU8a)(message);
  return (0, _keccak.keccak256AsU8a)((0, _util.u8aConcat)((0, _util.stringToU8a)('\x19Ethereum Signed Message:\n'), (0, _util.stringToU8a)(String(messageU8a.length)), messageU8a));
}