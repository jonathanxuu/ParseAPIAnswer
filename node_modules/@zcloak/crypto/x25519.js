// Copyright 2021-2023 zcloak authors & contributors
// SPDX-License-Identifier: Apache-2.0

import { u8aToU8a } from '@polkadot/util';
import { convertPublicKeyToCurve25519, convertSecretKeyToCurve25519, ed25519PairFromSeed } from "./ed25519/index.js";

/**
 * Returns a object containing a `publicKey` & `secretKey` generated from the supplied secretKey.
 */
export function x25519PairFromSeed(seed) {
  const pair = ed25519PairFromSeed(u8aToU8a(seed));
  return convertEd25519ToX25519(pair);
}
export function convertEd25519ToX25519(pair) {
  return {
    secretKey: convertSecretKeyToCurve25519(pair.secretKey),
    publicKey: convertPublicKeyToCurve25519(pair.publicKey)
  };
}